<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Linux | langhaidian</title>
<meta name=keywords content><meta name=description content="ExampleSite description"><meta name=author content="Me"><link rel=canonical href=https://examplesite.com/categories/linux/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://examplesite.com/categories/linux/index.xml><link rel=alternate hreflang=en href=https://examplesite.com/categories/linux/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://examplesite.com/categories/linux/"><meta property="og:site_name" content="langhaidian"><meta property="og:title" content="Linux"><meta property="og:description" content="ExampleSite description"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://examplesite.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://examplesite.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Linux"><meta name=twitter:description content="ExampleSite description"></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://examplesite.com/ accesskey=h title="Home (Alt + H)"><img src=https://examplesite.com/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://examplesite.com/archives/ title=归档><span>归档</span></a></li><li><a href=https://examplesite.com/tags/ title=标签><span>标签</span></a></li><li><a href=https://examplesite.com/about/ title=关于><span>关于</span></a></li><li><a href=https://langhaidian.github.io/running_page title=running_page><span>running_page</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://examplesite.com/>Home</a>&nbsp;»&nbsp;<a href=https://examplesite.com/categories/>Categories</a></div><h1>Linux
<a href=/categories/linux/index.xml title=RSS aria-label=RSS><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>linux设置时间</h2></header><div class=entry-content><p>最近碰到搭建测试k8s环境，系统版本太低导致很多问题，进行google后整理的升级步骤，供参考。 1. 系统时间查看和设置 查看系统时间的命令： #date 设置系统时间的命令： #date +"月/日/年 时:分:秒" [root@localhost sbin]# date +"12/13/2021 12:13:14" 12/13/2021 12:13:14 [root@localhost sbin]# date Sat May 29 18:02:37 CST 2021 2. 设置硬件时间 查看硬件时间的命令： # hwclock 设置硬件时间的命令： # hwclock --set --date="月/日/年 时:分:秒" [root@localhost sbin]# hwclock --set --date="2/1/2021 1:2:3" [root@localhost sbin]# hwclock Mon 01 Feb 2021 01:02:09 AM CST -0.848901 seconds 将系统时间写入硬件时间。hwclock --systohc</p></div><footer class=entry-footer><span title='2024-08-10 11:04:49 +0800 CST'>August 10, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;56 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to linux设置时间" href=https://examplesite.com/posts/linux/linux%E8%AE%BE%E7%BD%AE%E6%97%B6%E9%97%B4/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>geoscen server基础部署-centos 7.6</h2></header><div class=entry-content><p>1. 准备工作 1.1 关闭防火墙
停止防火墙：systemctl stop firewalld.service 禁用防火墙的开机启动：systemctl disable firewalld.service 查看防火墙状态：systemctl status firewalld.service 1.2 用户和组创建
# groupadd xcy # useradd -g xcy -m geoscene //绑定用户和用户组 # passwd geoscene //设置密码geoscene 1.3 修改计算机名：
# hostname //查看计算机名 # vi /etc/hostname 编辑机器名为xcytest后保存退出 # vi /etc/sysconfig/network 文件中的hostname修改为xcytest 1.4 修改hosts文件
# vi /etc/hosts 192.168.0.130 xcytest.portal.com xcytest //增加配置信息 1.5 检查主机名是否生效
# hostname xcytest //让修改立即生效 # hostname -f //查看完全限定域名 xcytest.portal.com 1.6 检查磁盘大小情况
df -h 确保/home/径路下存储空间满足要求 1.7 准备安装包 安装包：geoscene_datastore、geoscene_portal、geoscne_server、geoscene_webadapter_java 将安装包上传到/home/geoscen/azb
...</p></div><footer class=entry-footer><span title='2024-07-10 11:04:49 +0800 CST'>July 10, 2024</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;291 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to geoscen server基础部署-centos 7.6" href=https://examplesite.com/posts/linux/geoscenserver2.0%E5%9F%BA%E7%A1%80%E9%83%A8%E7%BD%B2/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>centos7离线安装docker</h2></header><div class=entry-content><p>内网环境centos 7.2需要安装docker，并运行相关系统 1. 查看内核版本 uname -msr 2. 更新软件版本 docker run –rm -v ${PWD}/bin:/tmp -it centos:7.6.1810 bash
In the online container: cd /tmp yum-config-manager –add-repo=https://download.docker.com/linux/centos/docker-ce.repo yum install -y yum-utils yum makecache fast yum list docker-ce –showduplicates | sort -r yumdownloader –resolve docker-ce-18.06.3.ce-3.el7 docker-ce-cli-24.0.7-1.el7 containerd.io-1.6.27-3.1.el7 docker-buildx-plugin-0.11.2-1.el7 docker-compose-plugin-2.21.0-1.el7 yum-utils
rpm -ivh –replacefiles –replacepkgs .rpm rpm -ivh ./openssh74pl/.rpm –force –nodeps
docker run –rm -v ${PWD}/bin:/tmp -it debian:11.7 bash
默认存放下载的deb文件的路径是 /var/cache/apt/archives
apt install –download-only xxxx
...</p></div><footer class=entry-footer><span title='2024-06-10 11:04:49 +0800 CST'>June 10, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;80 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to centos7离线安装docker" href=https://examplesite.com/posts/linux/cnetos7%E5%B0%8F%E7%89%88%E6%9C%AC%E5%AE%89%E8%A3%85docker/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>debian 11基础环境准备</h2></header><div class=entry-content><p>1. 替换默认源 cat &lt;&lt; EOF > /etc/apt/sources.list # Official sources.list deb http://deb.debian.org/debian bullseye main contrib non-free deb-src http://deb.debian.org/debian bullseye main contrib non-free deb http://deb.debian.org/debian bullseye-updates main contrib non-free deb-src http://deb.debian.org/debian bullseye-updates main contrib non-free deb http://deb.debian.org/debian bullseye-backports main contrib non-free deb-src http://deb.debian.org/debian bullseye-backports main contrib non-free deb http://security.debian.org/debian-security/ bullseye-security main contrib non-free deb-src http://security.debian.org/debian-security/ bullseye-security main contrib non-free EOF 更新系统： sudo apt update #更新源 sudo apt upgrade #更新已安装的包 sudo apt dist-upgrade #升级系统 sudo apt clean && sudo apt autoclean #清理下载文件的存档 2. 给root账户设置或者修改密码 passwd root 3. 安装sudo apt install sudo **给普通用户添加sudo权限 usermod -a -G sudo XXXX 4. 默认root禁止ssh远程登录(推荐保持默认) 修改配置文件 sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak sudo vi /etc/ssh/sshd_config #Authentication: #LoginGraceTime 2m #PermitRootLogin prohibit-password #StrictModes yes #MaxAuthTries 6 #MaxSessions 10 #PubkeyAuthentication yes 增加一句 PermitRootLogin yes 快速配置： sudo sed -i "/^#PermitRootLogin/c"PermitRootLogin" " yes"" /etc/ssh/sshd_config 补充： PermitRootLogin prohibit-password #允许 root 登录，但禁止适用密码认证 可以配合使用 Pubkey 认证，修改 PubkeyAuthentication yes 重启服务生效： sudo systemctl restart ssh 5. 配置网络 vim /etc/network/interfaces ============ # 修改为以下内容： iface lo inet loopback auto lo auto eth0 iface eth0 inet static address 10.10.1.5 netmask 255.255.255.0 #broadcast 10.10.1.255 #可选，上述配置了掩码 #network 10.10.1.0 #可选，上述配置了掩码 gateway 10.10.1.1 #dns-domain sysin.org # domain 和 search 不能共存；如果同时存在，后面出现的将会被使用。 dns-search sysin.org dns-nameservers 10.10.1.1 8.8.8.8 #注意 debian 11 默认没有安装 resolvconf，所以需要手动在 resolv.conf 中编辑 DNS ============ # 或者安装 resolvconf 后，在这里配置，将自动更新 resolv.conf sudo apt install resolvconf # iface eth0 inet6 auto #ipv6 自动配置，不写则表示禁用了 ============ # DHCP 配置如下： auto eth0 iface eth0 inet dhcp ============= # 配置 DNS cat /etc/resolv.conf #如果已经安装 resolvconf，不要手动编辑，直接在上述 interfaces 中编辑 dns ============= # 重启网络 sudo systemctl restart networking #sudo service networking restart ================= 配置多个ip auto eth0:0 iface eth0:0 inet static address 192.168.1.90 netmask 255.255.255.0 auto eth0:1 iface eth0:1 inet static address 192.168.1.91 netmask 255.255.255.0 gateway 192.168.1.1 ======= #添加静态路由信息 cat >> /etc/network/interfaces &lt;&lt;EOF # static routes up ip route add 10.10.12.0/24 via 10.10.1.1 dev eth0 up ip route add 10.10.13.0/24 via 10.10.1.1 dev eth0 up ip route add 10.10.14.0/24 via 10.10.1.1 dev eth0 up ip route add 10.10.15.0/24 via 10.10.1.1 dev eth0 up ip route add 10.10.16.0/24 via 10.10.1.1 dev eth0 EOF #重启网络 systemctl restart networking #验证 ip route 6. 修改主机名 vim /etc/hostname hostnamectl set-hostname debian-01 --static vim /etc/hosts # 添加一行 127.0.0.1 debian01.sysin.org debian01 # 注意这里的格式，IP 后面先写 FQDN 再写主机名，与 CentOS 相同 # 先写 FQDN 后写主机名，顺序反了不影响解析，但是'hostname -f'命令无法显示 FQDN，只能显示主机名 7. 安装intel无线网卡 查看网线设备信息 lspci -nn 安装wifi驱动包 apt update && apt install firmware-iwlwifi 重新加载wifi模块 modprobe -r iwlwifi ; modprobe iwlwifi 8. 修改默认ulimt参数 cat &lt;&lt; EOF >> /etc/security/limits.conf * soft nofile 65535 * hard nofile 65535 * soft nproc 65535 * hard nproc 65535 EOF cat &lt;&lt; EOF > /etc/security/limits.d/20-nproc.conf * soft nproc 65535 root soft nproc unlimited EOF 9. 安装openjdk8 ##sudo apt install apt-transport-https ca-certificates wget dirmngr gnupg software-properties-common wget -qO - https://adoptopenjdk.jfrog.io/adoptopenjdk/api/gpg/key/public | sudo apt-key add - sudo add-apt-repository --yes https://adoptopenjdk.jfrog.io/adoptopenjdk/deb/ sudo apt-get update && sudo apt-get install adoptopenjdk-8-hotspot sudo apt update sudo apt install adoptopenjdk-8-hotspot 10. 安装docker及docker-compose ## 卸载旧版本软件 sudo apt-get remove docker docker-engine docker.io containerd runc ## 安装依赖 sudo apt-get update sudo apt-get install \ ca-certificates \ curl \ gnupg \ lsb-release ## 导入gpg key curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg ## 添加仓库 echo \ "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/debian \ $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null ## 开始安装 sudo apt-get update sudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin 11. 设置时区 通过timedatectl进行设置 检查当前时区: timedatectl Local time: Fri 2020-04-03 19:23:29 UTC Universal time: Fri 2020-04-03 19:23:29 UTC RTC time: Fri 2020-04-03 19:23:29 Time zone: UTC (UTC, +0000) ..... ##更改时区 timedatectl list-timezones ｜ grep Shanghai ##过滤上海时区 sudo timedatectl set-timezone your_time_zone ##更改时区 sudo timedatectl set-timezone Asia/Shanghai ##设置上海时区 ##查看和验证时区 timedatectl Local time: Fri 2020-04-03 13:30:30 CST Universal time: Fri 2020-04-03 19:30:30 UTC RTC time: Fri 2020-04-03 19:30:30 Time zone: America/Monterrey (CST, -0600) ....... date ## 查看具体时间 通过软连接进行设置 较旧版本debian，没有timedatectl可以通过软连接进行设置，可以通过/etc/localtime文件符号链接到/usr/share/zoShanghai
...</p></div><footer class=entry-footer><span title='2024-06-10 11:04:49 +0800 CST'>June 10, 2024</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;691 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to debian 11基础环境准备" href=https://examplesite.com/posts/linux/debian11/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>centos7内核4.19升级到5.14</h2></header><div class=entry-content><p>最近碰到搭建测试k8s环境，系统版本太低导致很多问题，进行google后整理的升级步骤，供参考。 1. 查看内核版本 uname -msr 2. 更新软件版本 sudo yum -y update 3. 导入eplr rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org 4. ELRepo yum install https://www.elrepo.org/elrepo-release-7.el7.elrepo.noarch.rpm 5. 查找现有内核版本 yum list available --disablerepo='*' --enablerepo=elrepo-kernel * ML为主线版本，LT为长期支持版本 6. 安装内核版本 sudo yum --enablerepo=elrepo-kernel install kernel-lt 7. 删除旧版本tools yum remove kernel-tools-libs.x86_64 kernel.x86_64 -y yum remove kernel-tools-libs.x86_64 kernel-tools.x86_64 -y 8. 安装工具包 yum --disablerepo=\* --enablerepo=elrepo-kernel install kernel-lt-tools.x86_64 -y 9. 重启手动选择内核进入系统检查系统情况 reboot 10. 查看所有启动内核 awk -F \' '$1=="menuentry " {print i++ " : " $2}' /etc/grub2.cfg 修改默认启动内核：grub2-set-default 0 11. 编辑启动顺序 sudo vim /etc/default/grub --------------------- * Once the file opens, look for the line that says GRUB_DEFAULT=X, and change it to GRUB_DEFAULT=0 (zero). * This line will instruct the boot loader to default to the first kernel on the list, which is the latest. 将GRUB_DEFAULT=X 修改成GRUB_DEFAULT=0 加载第一个内核版本并且为最后一个版本 12. 更新启动配置文件 sudo grub2-mkconfig -o /boot/grub2/grub.cfg 13. 查看启动顺序 grub2-editenv list 14. 重启验证 reboot</p></div><footer class=entry-footer><span title='2024-05-10 11:04:49 +0800 CST'>May 10, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;137 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to centos7内核4.19升级到5.14" href=https://examplesite.com/posts/linux/cnetos7%E5%8D%87%E7%BA%A7%E5%86%85%E6%A0%B8/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>containerd安装</h2></header><div class=entry-content><p>debian 11安装(建议debian内核为5.11以后)
需要安装内容 containerd、runc、CNI plugins、nerdctl(客户端) 安装containerd a. 进入下载对应版本https://github.com/containerd/containerd/releases wget https://github.com/containerd/containerd/releases/download/v1.7.2/containerd-1.7.2-linux-amd64.tar.gz b. shell> tar Cxzvf /usr/local containerd-1.6.2-linux-amd64.tar.gz bin/ c. 配置开机启动服务 服务配置文件内容：https://raw.githubusercontent.com/containerd/containerd/main/containerd.service vim /etc/systemd/system/containerd.service ---------------- # Copyright The containerd Authors. # # Licensed under the Apache License, Version 2.0 (the "License"); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an "AS IS" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. [Unit] Description=containerd container runtime Documentation=https://containerd.io After=network.target local-fs.target [Service] #uncomment to enable the experimental sbservice (sandboxed) version of containerd/cri integration #Environment="ENABLE_CRI_SANDBOXES=sandboxed" ExecStartPre=-/sbin/modprobe overlay ExecStart=/usr/local/bin/containerd Type=notify Delegate=yes KillMode=process Restart=always RestartSec=5 # Having non-zero Limit*s causes performance problems due to accounting overhead # in the kernel. We recommend using cgroups to do container-local accounting. LimitNPROC=infinity LimitCORE=infinity LimitNOFILE=infinity # Comment TasksMax if your systemd version does not supports it. # Only systemd 226 and above support this version. TasksMax=infinity OOMScoreAdjust=-999 [Install] WantedBy=multi-user.target ----------------- shell> systemctl daemon-reload shell> systemctl enable --now containerd 安装runc 下载对应安装文件：https://github.com/opencontainers/runc/releases shell> install -m 755 runc.amd64 /usr/local/sbin/runc 安装CNI plugins 下载对应安装文件：https://github.com/containernetworking/plugins/releases shell> mkdir -p /opt/cni/bin shell> tar Cxzvf /opt/cni/bin cni-plugins-linux-amd64-v1.1.1.tgz 安装nerdctl 下载对应安装文件：https://github.com/containerd/nerdctl/releases shell> tar Cxzvvf /usr/local/bin nerdctl-1.4.0-linux-amd64.tar.gz 配置：Rootless a. 安装依赖： shell> sudo apt-get purge apparmor apparmor-utils auditd shell> sudo apt-get install uidmap shell> sudo apt-get install slirp4netns 特殊配置： 1. 开启overlay echo "options overlay permit_mounts_in_userns=1" > /etc/modprobe.d/mdadm.conf 2. 开启配置cgroup v2 shell> vim /etc/default/grub ------ GRUB_CMDLINE_LINUX="systemd.unified_cgroup_hierarchy=1" ------ shell> sudo update-grub. -------- Enabling CPU, CPUSET, and I/O delegation $ cat /sys/fs/cgroup/user.slice/user-$(id -u).slice/user@$(id -u).service/cgroup.controllers memory pids $ sudo mkdir -p /etc/systemd/system/user@.service.d $ cat &lt;&lt;EOF | sudo tee /etc/systemd/system/user@.service.d/delegate.conf [Service] Delegate=cpu cpuset io memory pids EOF $ sudo systemctl daemon-reload --------- shell> containerd-rootless-setuptool.sh install iptable 问题： I had the same issue and in my system (debian bullseye) iptables and ip6tables was installed only under /usr/sbin. A quick fix was to make a link in /usr/local/bin ln -s /usr/sbin/iptables /usr/local/bin/iptables ln -s /usr/sbin/ip6tables /usr/local/bin/ip6tables</p></div><footer class=entry-footer><span title='2024-05-10 11:04:49 +0800 CST'>May 10, 2024</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;353 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to containerd安装" href=https://examplesite.com/posts/linux/containerd%E5%AE%89%E8%A3%85/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>debian升级内核</h2></header><div class=entry-content><p>最近碰到搭建测试k8s环境，系统版本太低导致很多问题，进行google后整理的升级步骤，供参考。 1. 查看内核版本 uname -msr 2. 更新软件版本 sudo yum -y update 3. 导入eplr rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org 4. ELRepo yum install https://www.elrepo.org/elrepo-release-7.el7.elrepo.noarch.rpm 5. 查找现有内核版本 yum list available --disablerepo='*' --enablerepo=elrepo-kernel * ML为主线版本，LT为长期支持版本 6. 安装内核版本 sudo yum --enablerepo=elrepo-kernel install kernel-lt 7. 删除旧版本tools yum remove kernel-tools-libs.x86_64 kernel.x86_64 -y yum remove kernel-tools-libs.x86_64 kernel-tools.x86_64 -y 8. 安装工具包 yum --disablerepo=\* --enablerepo=elrepo-kernel install kernel-lt-tools.x86_64 -y 9. 重启手动选择内核进入系统检查系统情况 reboot 10. 查看所有启动内核 awk -F \' '$1=="menuentry " {print i++ " : " $2}' /etc/grub2.cfg 修改默认启动内核：grub2-set-default 0 11. 编辑启动顺序 sudo vim /etc/default/grub --------------------- * Once the file opens, look for the line that says GRUB_DEFAULT=X, and change it to GRUB_DEFAULT=0 (zero). * This line will instruct the boot loader to default to the first kernel on the list, which is the latest. 将GRUB_DEFAULT=X 修改成GRUB_DEFAULT=0 加载第一个内核版本并且为最后一个版本 12. 更新启动配置文件 sudo grub2-mkconfig -o /boot/grub2/grub.cfg 13. 查看启动顺序 grub2-editenv list 14. 重启验证 reboot</p></div><footer class=entry-footer><span title='2024-02-10 11:04:49 +0800 CST'>February 10, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;137 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to debian升级内核" href=https://examplesite.com/posts/linux/debian%E5%8D%87%E7%BA%A7%E5%86%85%E6%A0%B8/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>sed简单介绍</h2></header><div class=entry-content><p>语法 sed options...[script][inputfile] 第一部分 准备测试数据 cat &lt;&lt;EOF > sedtest.conf unix is great os. unix is opensource. unix is free os. learn operating system. unix linux which one you choose. unix is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful. EOF 1. 替换每行第一个字符 $ sed 's/unix/linux/' sedtest.conf Output : linux is great os. unix is opensource. unix is free os. learn operating system. linux linux which one you choose. linux is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful. 2. 替换每行第二个字符 $ sed 's/unix/linux/2' sedtest.conf Output : unix is great os. linux is opensource. unix is free os. learn operating system. unix linux which one you choose. unix is easy to learn.linux is a multiuser os.Learn unix .unix is a powerful. 3. 替换每行所有字符 $ sed 's/unix/linux/g' sedtest.conf Output : linux is great os. linux is opensource. linux is free os. learn operating system. linux linux which one you choose. linux is easy to learn.linux is a multiuser os.Learn linux .linux is a powerful. 4. 替换每行第三个开始的字符 $ sed 's/unix/linux/3g' sedtest.conf Output : unix is great os. unix is opensource. linux is free os. learn operating system. unix linux which one you choose. unix is easy to learn.unix is a multiuser os.Learn linux .linux is a powerful. 5. 字符分割加符号 $ echo "Welcome To The Geek Stuff" | sed 's/\(\b[A-Z]\)/\(\1\)/g' Output : (W)elcome (T)o (T)he (G)eek (S)tuff 6. 替换第几行的第一个字符(第三行) $ sed '3 s/unix/linux' sedtest.conf Output : unix is great os. unix is opensource. unix is free os. learn operating system. linux linux which one you choose. unix is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful. 7. 显示被替换的行内容(被替换的显示双行，没有替换的显示原始数据) $ sed 's/unix/linux/p' sedtest.conf Output : linux is great os. unix is opensource. unix is free os. linux is great os. unix is opensource. unix is free os. learn operating system. linux linux which one you choose. linux linux which one you choose. linux is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful. linux is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful. 8. 只显示被替换的内容 $ sed -n 's/unix/linux/p' sedtest.conf Output : linux is great os. unix is opensource. unix is free os. linux linux which one you choose. linux is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful. 9. 替换给定行数字符 $ sed '1,3 s/unix/linux/' sedtest.conf Output : linux is great os. unix is opensource. unix is free os. learn operating system. linux linux which one you choose. unix is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful. $ sed '2,$ s/unix/linux/' geekfile.txt Output : unix is great os. unix is opensource. unix is free os. learn operating system. linux linux which one you choose. linux is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful *** $ 代表文件最后一行内容 *** 10. 删除行内容 语法：$ sed 'nd' filename.txt 例子：$ sed '5d' filename.txt $ sed '$d' filename.txt //删除最后一行内容 $ sed 'x,yd' filename.txt //删除x到y之间行内容 sed '3,6d' filename.txt $ sed 'nth,$d' filename.txt // 删除第几行到最后一行 sed '12,$d' filename.txt $ sed '/pattern/d' filename.txt //删除匹配到行 sed '/abc/d' filename.txt 第二部分 准备测试数据 cat &lt;&lt;EOF > sedtest.txt life isn't meant to be easy, life is meant to be lived. Try to learn & understand something new everyday in life. Respect everyone & most important love everyone. Don’t hesitate to ask for love & don’t hesitate to show love too. Life is too short to be shy. In life, experience will help you differentiating right from wrong. EOF 文件间距处理 1. 每行最后插入一个空白行 $ sed G sedtest.txt Output: life isn't meant to be easy, life is meant to be lived. Try to learn & understand something new everyday in life. Respect everyone & most important love everyone. Don’t hesitate to ask for love & don’t hesitate to show love too. Life is too short to be shy. In life, experience will help you differentiating right from wrong. 2. 插入2行空白行 sed 'G;G' sedtest.txt 3. 删除空白行，在每行后面插入空白行 sed '/^$/d;G' sedtest.txt 4. 在匹配行上面插入一条黑线(匹配love) sed '/love/{x;p;x;}' sedtest.txt 5. 在匹配行下面插入空白行(匹配love) sed '/love/G' sedtest.txt 6. 在每行左边插入5个空格 sed 's/^/ /' sedtest.txt 编号处理 1. 每一行进行编号(左对齐)，\t为数字跟语句之间的制表符 sed = a.txt | sed 'N;s/\n/\t' 2. 每行插入编号(数字左边，右对齐)，类似于cat -n filename 增加编号效果 sed '/./=' a.txt | sed 'N;s/^/ ;s/*\(.\{4,\}\)\n/\1 /' 3. 不为空行进行编号 sed '/./=' a.txt | sed '/./N; s/\n/ /' 删除行 1. 删除指定行数 sed '5d' a.txt //删除第五行 2. 删除最后一行 sed '$d' a.txt //$ 代表最后一行 3. 删除指定范围行数内容 sed '3,5d' a.txt //删除第3-5行内容 4.删除置指定行数到最后一行 sed '2,$d' a.txt //第二行到最后一行 5. 删除匹配内容行内容 sed '/life/d' a.txt 6. 删除从第n行开始的2行内容 sed '3~2d' a.txt 7. 删除匹配内容及其后的两行 sed '/easy/,+2d' a.txt 8. 删除空白行 sed '^$/d' a.txt 9. 删除空白行及#开始内容 sed -i '/^#/d;/^$/d' a.txt 查看打印文件 1. 查看指定范围行数内容 sed -n '2,5p' a.txt 2. 查看指定范围外内容 sed '2,4d' a.txt 3. 查看文件第几行 sed -n '4'p a.txt //第4行内容 4. 查看指定范围内内容 sed -n '4,6'p a.txt 5. 查看最后一行内容 sed -n '$'p a.txt 6. 查看指定行术到最后一行内容 sed -n '3,$'p a.txt //第三行到最后一行 7 打印匹配内容行内容 sed -n /every/p a.txt 8. 打印匹配内容到到第n行 sed -n '/everyone/,5p' a.txt //从匹配行打印到第5行 9. 打印从第x行开始直到匹配的行内容 sed -n ‘x,/pattern/p’ filename sed -n '1,/everyone/p' a.txt 10. 打印匹配的行直到第x行 sed -n '/pattern/,+xp' filename sde -n '/learn/,+2p' a.txt 替换命令 1. 替换第一次出现的内容 sed 's/life/leaves/' a.txt 2. 替换一行中第x次出现内容 sed 's/to/two/2' a.txt 3. 替换所有内容 sed 's/life/learn/g' a.txt 4. 替换从第x开始的字符 sed 's/to/TWO/2g' a.txt 5. 替换第x行内容 sed '3 s/every/each/' a.txt sed '3 s/every/each/p' a.txt //打印 6. 替换指定范围内行内容 sed '2,5 s/to/TWO/' a.txt 7. 替换内容忽略大小写 sed 's/life/Love/i' a.txt sed 's/[Ll]ife/Love/g' a.txt //匹配life、Life替换内容 8. 使用一个空格替换所有 sed 's/ */ /g' filename 9. 使用一种匹配模式替换另一个内容 Syntax: sed ‘/followed_pattern/ s/old_pattern/new_pattern/’ filename sed '/is/ s/live/love' a.txt //匹配第一个内容去替换 10. 除过第x行 sed -i '5!s/life/love' a.txt //第5行除过</p></div><footer class=entry-footer><span title='2023-09-10 11:04:49 +0800 CST'>September 10, 2023</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;901 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to sed简单介绍" href=https://examplesite.com/posts/linux/sed/></a></article></main><footer class=footer><span>&copy; 2024 <a href=https://examplesite.com/>langhaidian</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>