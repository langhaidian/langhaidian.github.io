<!doctype html><html lang=en dir=auto><head><meta name=generator content="Hugo 0.140.0"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>langhaidian</title>
<meta name=keywords content="Blog,Portfolio,PaperMod"><meta name=description content="ExampleSite description"><meta name=author content="Me"><link rel=canonical href=https://examplesite.com/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://examplesite.com/index.xml><link rel=alternate hreflang=en href=https://examplesite.com/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://examplesite.com/"><meta property="og:site_name" content="langhaidian"><meta property="og:title" content="langhaidian"><meta property="og:description" content="ExampleSite description"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://examplesite.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://examplesite.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="langhaidian"><meta name=twitter:description content="ExampleSite description"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"langhaidian","url":"https://examplesite.com/","description":"ExampleSite description","logo":"https://examplesite.com/%3Clink%20/%20abs%20url%3E","sameAs":["https://www.instagram.com/langhaidian/","https://github.com/langhaidian/"]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://examplesite.com/ accesskey=h title="Home (Alt + H)"><img src=https://examplesite.com/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://examplesite.com/archives/ title=归档><span>归档</span></a></li><li><a href=https://examplesite.com/tags/ title=标签><span>标签</span></a></li><li><a href=https://examplesite.com/about/ title=关于><span>关于</span></a></li><li><a href=https://langhaidian.github.io/running_page title=running_page><span>running_page</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>linux设置时间</h2></header><div class=entry-content><p>最近碰到搭建测试k8s环境，系统版本太低导致很多问题，进行google后整理的升级步骤，供参考。 1. 系统时间查看和设置 查看系统时间的命令： #date 设置系统时间的命令： #date +"月/日/年 时:分:秒" [root@localhost sbin]# date +"12/13/2021 12:13:14" 12/13/2021 12:13:14 [root@localhost sbin]# date Sat May 29 18:02:37 CST 2021 2. 设置硬件时间 查看硬件时间的命令： # hwclock 设置硬件时间的命令： # hwclock --set --date="月/日/年 时:分:秒" [root@localhost sbin]# hwclock --set --date="2/1/2021 1:2:3" [root@localhost sbin]# hwclock Mon 01 Feb 2021 01:02:09 AM CST -0.848901 seconds 将系统时间写入硬件时间。hwclock --systohc</p></div><footer class=entry-footer><span title='2022-02-10 11:04:49 +0800 CST'>February 10, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;56 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to linux设置时间" href=https://examplesite.com/posts/linux/linux%E8%AE%BE%E7%BD%AE%E6%97%B6%E9%97%B4/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>mkcert生成GeosceneServer证书</h2></header><div class=entry-content><p>解决Geoscene Server证书自己生成碰到浏览器不信任问题。采用mkcert工具生成相关证书。 准备软件： mkcert： https://github.com/FiloSottile/mkcert/releases openssl：https://slproweb.com/download/Win64OpenSSL_Light-1_1_1q.msi
证书生成 定位到mkcert目录下，查看帮助
mkcert --help 安装CA证书
mkcert -install 生成证书,可以给定ip地址，*.portal.com通配符域名，具体域名gx42.portal.com等。当前目录下会生成两个.pem文件。
mkcert 192.168.28.42 192.168.28.215 "*.portal.com" gx42.portal.com 将192.168.X.X-key.pem文件转换成key openssl rsa -in 192.168.X.X.pem -out 192.168.X.X.key 利用openssl生成pfx证书,设定密码以及记录相关密码，tomcat配置时使用。
openssl> pkcs12 -export -out d:\mkcert\192.168.X.X.pfx -in d:\mkcert\192.168.X.X.pem -inkey d:\mkcert\192.168.X.X.key 查找CA证书安装位置
mkcert -CAROOT 将 rootCA.pem 转换成.crt格式，用于客户端安装自签名证书使用
openssl x509 -in rootCA.pem -out rootCA.crt 双击rootCA.crt进行安装,按照提示将证书存储到受信任的根证书颁发机构。
配置tomcat证书信息
&lt;!--&lt;Connector port="8443" protocol="org.apache.coyote.http11.Http11NioProtocol....>" --> Modify the connector to match the parameters below: &lt;Connector port="443" protocol="org.apache.coyote.http11.Http11AprProtocol" maxThreads="150" SSLEnabled="true" > &lt;UpgradeProtocol className="org.apache.coyote.http2.Http2Protocol" /> &lt;SSLHostConfig> &lt;Certificate certificateKeystoreFile="conflocalhost-rsa-key.pem" certificateKeystorePassword="con" type="RSA" /> &lt;/SSLHostConfig> &lt;/Connector> &lt;Connector port="443" protocol="org.apache.coyote.http11.Http11AprProtocol" maxThreads="150" SSLEnabled="true" > &lt;UpgradeProtocol className="org.apache.coyote.http2.Http2Protocol" /> &lt;SSLHostConfig> &lt;Certificate certificateKeystoreFile="conf/ssl/172.26.156.21.pfx" certificateKeystorePassword="gxzb@123" type="PKCS12" /> &lt;/SSLHostConfig> &lt;/Connector> keytools: keytool -genkey -alias mykey -keyalg RSA -keystore keystore.jks -validity 3650 &lt;Connector port="443" protocol="org.apache.coyote.http11.Http11AprProtocol" maxThreads="150" SSLEnabled="true" scheme="https" secure="true" keystoreFile="/path/to/keystore.jks" keystorePass="password" clientAuth="false" sslProtocol="TLS"/> &lt;Connector port="443" protocol="org.apache.coyote.http11.Http11NioProtocol" maxThreads="550" SSLEnabled="true" scheme="https" secure="true" keystoreFile="ssl/anyangarcgis.jks" keystorePass="anyang" clientAuth="false" sslProtocol="TLS"/> &lt;Connector port="443" protocol="org.apache.coyote.http11.Http11NioProtocol" maxThreads="550" SSLEnabled="true"> &lt;UpgradeProtocol className="org.apache.coyote.http2.Http2Protocol"/> &lt;SSLHostConfig> &lt;Certificate certificateKeystoreFile="conf/cert/xkcdxgx.pfx" certificateKeystorePassword="anyang" type="RSA"/> &lt;/SSLHostConfig> &lt;/Connector> {"WebContextURL":"https://59.227.104.202/arcgis"} nginx: server { listen 443 ssl; server_name 59.227.104.202 10.10.146.36 gx36.portal.com; ssl_certificate /etc/nginx/ssl/gx36.portal.com+5.pem ssl_certificate_key /etc/nginx/ssl/gx36.portal.com+5-key.pem ssl_session_cache shared:SSL:1m; ssl_session_timeout 5m; ssl_ciphers HIGH:!aNULL:!MD5; ssl_prefer_server_ciphers on; location /server { proxy_pass https://gx36.portal.com/server; proxy_ignore_client_abort on; proxy_cookie_path /server /server proxy_set_header Host $host:$server_port; proxy_set_header X-Real-IP ""; # ArcGIS Server 要求必须添加 X-Forwarded-Host 反代标头 proxy_set_header X-Real-PORT $remote_port; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; } location /arcgis { proxy_pass https://gx36.portal.com/arcgis; proxy_ignore_client_abort on; proxy_cookie_path /arcgis /arcgis proxy_set_header Host $host:$server_port; proxy_set_header X-Real-IP ""; # ArcGIS Server 要求必须添加 X-Forwarded-Host 反代标头 proxy_set_header X-Real-PORT $remote_port; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; } }</p></div><footer class=entry-footer><span title='2022-02-10 11:04:49 +0800 CST'>February 10, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;225 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to mkcert生成GeosceneServer证书" href=https://examplesite.com/posts/linux/mkcert%E7%94%9F%E6%88%90geosceneserver%E8%AF%81%E4%B9%A6/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>postgresql简单记录备份</h2></header><div class=entry-content><p>备份 pg_dump -F c -F 路径/testdb.dmp -h 127.0.0.1 -U postgres testdb
恢复 pg_restore -d testdb testdb.dmp -h 127.0.0.1 -U postgres
数据库归档模式： 1. 修改postgresql.conf文件中的相关参数，包括： archive_mode = on # 开启归档模式，可以是off, on, 或者always archive_command = ‘DATE=`date +%Y%m%d`;DIR=/var/lib/postgresql/arch/$DATE;test ! -d $DIR && mkdir -p $DIR;test ! -f $DIR/%f && cp %p $DIR/%f’ # 指定归档命令，可以是一个shell命令或者脚本，其中%p表示WAL文件的完整路径，%f表示WAL文件的名称 wal_level = replica # 或者logical，指定WAL日志的输出级别，minimal不支持归档 2. 创建归档目录，并赋予postgres用户相应的权限，例如： mkdir -p /var/lib/postgresql/arch chown -R postgres.postgres /var/lib/postgresql/arch/ 3. 重启PostgreSQL服务，使配置生效，例如： service postgresql-13 restart 4. 验证归档模式是否开启成功，可以通过以下方法： 查看archive_mode参数的值，应该是on或者always 手动切换WAL日志文件，使用select pg_switch_wal()命令，并查看归档目录是否有新的WAL文件生成 查看日志文件中是否有归档相关的信息或者错误 备份脚本 #!/bin/bash BACKUP_LOCAL_DIR=/opt/local BACKUP_CON_DIR=/opt/con BACKUP_DAY=7 #数据库名称 DB_NAME_dev=dev_dotnet TODAY=`data +%Y-%m-%d` #删除超过7天的备份 find $BACKUP_LOCAL_DIR -type f -name dev_dotent* -mtime +BACKUP_DAY -exec rm -rf {} \; #进行数据备份 sudo docker exec -it postgres pg_dump -F c -f $BACKUP_CON_DIR/dev_dotnet_$TODAY.dmp -h 127.0.0.1 -U postgres dev_dotnet #压缩备份文件 sudo gzip $BACKUP_LOCAL_DIR/dev_dotnet_$TODAY.dmp #显示备份成功 echo "$DB_NAME_dev $TODAY 数据库备份成功！" #归档日志处理 vi postgresql.conf archive_mode = on archive_command = 'DATE=`date +%Y%m%d`; DIR="/var/lib/postgresql/arch/$DATE"; test ! -d $DIR && mkdir -p $DIR; test ! -f $DIR/%f && cp %p %DIR/%f; find /var/lib/postgresql/arch/ -type d -mtime 7 -exec rm -f {} \;'</p></div><footer class=entry-footer><span title='2022-02-10 11:04:49 +0800 CST'>February 10, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;161 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to postgresql简单记录备份" href=https://examplesite.com/posts/postgres/postgers%E5%A4%87%E4%BB%BD%E5%9B%9E%E5%A4%8D/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>raft算法中文讲解</h2></header><div class=entry-content><p>寻找一种易于理解的一致性算法（扩展版） 寻找一种易于理解的一致性算法（扩展版） 摘要 1 介绍 2 复制状态机 3 Paxos 算法的问题 4 为了可理解性的设计 5 Raft 一致性算法 5.1 Raft 基础 5.2 领导人选举 5.3 日志复制 5.4 安全性 5.4.1 选举限制 5.4.2 提交之前任期内的日志条目 5.4.3 安全性论证 5.5 跟随者和候选人崩溃 5.6 时间和可用性 6 集群成员变化 7 日志压缩 8 客户端交互 9 算法实现和评估 9.1 可理解性 9.2 正确性 9.3 性能 10 相关工作 11 结论 12 感谢 参考 摘要 Raft 是一种为了管理复制日志的一致性算法。它提供了和 Paxos 算法相同的功能和性能，但是它的算法结构和 Paxos 不同，使得 Raft 算法更加容易理解并且更容易构建实际的系统。为了提升可理解性，Raft 将一致性算法分解成了几个关键模块，例如领导人选举、日志复制和安全性。同时它通过实施一个更强的一致性来减少需要考虑的状态的数量。一项用户研究的结果表明，对于学生而言，Raft 算法比 Paxos 算法更加容易学习。Raft 算法还包括一个新的机制来允许集群成员的动态改变，它利用重叠的大多数来保证安全性。
1 介绍 一致性算法允许一组机器像一个整体一样工作，即使其中一些机器出现故障也能够继续工作下去。正因为如此，一致性算法在构建可信赖的大规模软件系统中扮演着重要的角色。在过去的 10 年里，Paxos 算法统治着一致性算法这一领域：绝大多数的实现都是基于 Paxos 或者受其影响。同时 Paxos 也成为了教学领域里讲解一致性问题时的示例。
...</p></div><footer class=entry-footer><span title='2022-02-10 11:04:49 +0800 CST'>February 10, 2022</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;1565 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to raft算法中文讲解" href=https://examplesite.com/posts/linux/raft-zh_cn/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>sed简单介绍</h2></header><div class=entry-content><p>语法 sed options...[script][inputfile] 第一部分 准备测试数据 cat &lt;&lt;EOF > sedtest.conf unix is great os. unix is opensource. unix is free os. learn operating system. unix linux which one you choose. unix is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful. EOF 1. 替换每行第一个字符 $ sed 's/unix/linux/' sedtest.conf Output : linux is great os. unix is opensource. unix is free os. learn operating system. linux linux which one you choose. linux is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful. 2. 替换每行第二个字符 $ sed 's/unix/linux/2' sedtest.conf Output : unix is great os. linux is opensource. unix is free os. learn operating system. unix linux which one you choose. unix is easy to learn.linux is a multiuser os.Learn unix .unix is a powerful. 3. 替换每行所有字符 $ sed 's/unix/linux/g' sedtest.conf Output : linux is great os. linux is opensource. linux is free os. learn operating system. linux linux which one you choose. linux is easy to learn.linux is a multiuser os.Learn linux .linux is a powerful. 4. 替换每行第三个开始的字符 $ sed 's/unix/linux/3g' sedtest.conf Output : unix is great os. unix is opensource. linux is free os. learn operating system. unix linux which one you choose. unix is easy to learn.unix is a multiuser os.Learn linux .linux is a powerful. 5. 字符分割加符号 $ echo "Welcome To The Geek Stuff" | sed 's/\(\b[A-Z]\)/\(\1\)/g' Output : (W)elcome (T)o (T)he (G)eek (S)tuff 6. 替换第几行的第一个字符(第三行) $ sed '3 s/unix/linux' sedtest.conf Output : unix is great os. unix is opensource. unix is free os. learn operating system. linux linux which one you choose. unix is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful. 7. 显示被替换的行内容(被替换的显示双行，没有替换的显示原始数据) $ sed 's/unix/linux/p' sedtest.conf Output : linux is great os. unix is opensource. unix is free os. linux is great os. unix is opensource. unix is free os. learn operating system. linux linux which one you choose. linux linux which one you choose. linux is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful. linux is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful. 8. 只显示被替换的内容 $ sed -n 's/unix/linux/p' sedtest.conf Output : linux is great os. unix is opensource. unix is free os. linux linux which one you choose. linux is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful. 9. 替换给定行数字符 $ sed '1,3 s/unix/linux/' sedtest.conf Output : linux is great os. unix is opensource. unix is free os. learn operating system. linux linux which one you choose. unix is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful. $ sed '2,$ s/unix/linux/' geekfile.txt Output : unix is great os. unix is opensource. unix is free os. learn operating system. linux linux which one you choose. linux is easy to learn.unix is a multiuser os.Learn unix .unix is a powerful *** $ 代表文件最后一行内容 *** 10. 删除行内容 语法：$ sed 'nd' filename.txt 例子：$ sed '5d' filename.txt $ sed '$d' filename.txt //删除最后一行内容 $ sed 'x,yd' filename.txt //删除x到y之间行内容 sed '3,6d' filename.txt $ sed 'nth,$d' filename.txt // 删除第几行到最后一行 sed '12,$d' filename.txt $ sed '/pattern/d' filename.txt //删除匹配到行 sed '/abc/d' filename.txt 第二部分 准备测试数据 cat &lt;&lt;EOF > sedtest.txt life isn't meant to be easy, life is meant to be lived. Try to learn & understand something new everyday in life. Respect everyone & most important love everyone. Don’t hesitate to ask for love & don’t hesitate to show love too. Life is too short to be shy. In life, experience will help you differentiating right from wrong. EOF 文件间距处理 1. 每行最后插入一个空白行 $ sed G sedtest.txt Output: life isn't meant to be easy, life is meant to be lived. Try to learn & understand something new everyday in life. Respect everyone & most important love everyone. Don’t hesitate to ask for love & don’t hesitate to show love too. Life is too short to be shy. In life, experience will help you differentiating right from wrong. 2. 插入2行空白行 sed 'G;G' sedtest.txt 3. 删除空白行，在每行后面插入空白行 sed '/^$/d;G' sedtest.txt 4. 在匹配行上面插入一条黑线(匹配love) sed '/love/{x;p;x;}' sedtest.txt 5. 在匹配行下面插入空白行(匹配love) sed '/love/G' sedtest.txt 6. 在每行左边插入5个空格 sed 's/^/ /' sedtest.txt 编号处理 1. 每一行进行编号(左对齐)，\t为数字跟语句之间的制表符 sed = a.txt | sed 'N;s/\n/\t' 2. 每行插入编号(数字左边，右对齐)，类似于cat -n filename 增加编号效果 sed '/./=' a.txt | sed 'N;s/^/ ;s/*\(.\{4,\}\)\n/\1 /' 3. 不为空行进行编号 sed '/./=' a.txt | sed '/./N; s/\n/ /' 删除行 1. 删除指定行数 sed '5d' a.txt //删除第五行 2. 删除最后一行 sed '$d' a.txt //$ 代表最后一行 3. 删除指定范围行数内容 sed '3,5d' a.txt //删除第3-5行内容 4.删除置指定行数到最后一行 sed '2,$d' a.txt //第二行到最后一行 5. 删除匹配内容行内容 sed '/life/d' a.txt 6. 删除从第n行开始的2行内容 sed '3~2d' a.txt 7. 删除匹配内容及其后的两行 sed '/easy/,+2d' a.txt 8. 删除空白行 sed '^$/d' a.txt 9. 删除空白行及#开始内容 sed -i '/^#/d;/^$/d' a.txt 查看打印文件 1. 查看指定范围行数内容 sed -n '2,5p' a.txt 2. 查看指定范围外内容 sed '2,4d' a.txt 3. 查看文件第几行 sed -n '4'p a.txt //第4行内容 4. 查看指定范围内内容 sed -n '4,6'p a.txt 5. 查看最后一行内容 sed -n '$'p a.txt 6. 查看指定行术到最后一行内容 sed -n '3,$'p a.txt //第三行到最后一行 7 打印匹配内容行内容 sed -n /every/p a.txt 8. 打印匹配内容到到第n行 sed -n '/everyone/,5p' a.txt //从匹配行打印到第5行 9. 打印从第x行开始直到匹配的行内容 sed -n ‘x,/pattern/p’ filename sed -n '1,/everyone/p' a.txt 10. 打印匹配的行直到第x行 sed -n '/pattern/,+xp' filename sde -n '/learn/,+2p' a.txt 替换命令 1. 替换第一次出现的内容 sed 's/life/leaves/' a.txt 2. 替换一行中第x次出现内容 sed 's/to/two/2' a.txt 3. 替换所有内容 sed 's/life/learn/g' a.txt 4. 替换从第x开始的字符 sed 's/to/TWO/2g' a.txt 5. 替换第x行内容 sed '3 s/every/each/' a.txt sed '3 s/every/each/p' a.txt //打印 6. 替换指定范围内行内容 sed '2,5 s/to/TWO/' a.txt 7. 替换内容忽略大小写 sed 's/life/Love/i' a.txt sed 's/[Ll]ife/Love/g' a.txt //匹配life、Life替换内容 8. 使用一个空格替换所有 sed 's/ */ /g' filename 9. 使用一种匹配模式替换另一个内容 Syntax: sed ‘/followed_pattern/ s/old_pattern/new_pattern/’ filename sed '/is/ s/live/love' a.txt //匹配第一个内容去替换 10. 除过第x行 sed -i '5!s/life/love' a.txt //第5行除过</p></div><footer class=entry-footer><span title='2022-02-10 11:04:49 +0800 CST'>February 10, 2022</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;901 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to sed简单介绍" href=https://examplesite.com/posts/linux/sed/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>tomcat设置系统服务</h2></header><div class=entry-content><p>编辑系统服务
vi /etc/systemd/system/tomcat.service [Unit] Description=Tomcat8540 After=syslog.target network.target remote-fs.target nss-lookup.target [Service] Type=oneshot ExecStart=/usr/local/apache-tomcat-8.5.40/bin/startup.sh ExecStop=/usr/local/apache-tomcat-8.5.40/bin/shutdown.sh ExecReload=/bin/kill -s HUP $MAINPID RemainAfterExit=yes [Install] WantedBy=multi-user.target 设置开机启动
systemctl enable tomcat 启动服务
systemctl start tomcat</p></div><footer class=entry-footer><span title='2022-02-10 11:04:49 +0800 CST'>February 10, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;28 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to tomcat设置系统服务" href=https://examplesite.com/posts/linux/tomcat%E8%AE%BE%E7%BD%AE%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>virtualenv虚拟环境使用</h2></header><div class=entry-content><p>python的虚拟环境有很多选择，今天只记录virtualenv简单使用
1. 安装virtualenv pip install virtualenv 2. 创建虚拟环境并指定python版本,会在本目录下创建下虚拟环境 virtualenv venv --python=pythonx.x.x 3. 进入虚拟环境 source venv/bin/activate 4. 退出虚拟环境 deactivate 5. 删除虚拟环境 rm -rf venv</p></div><footer class=entry-footer><span title='2022-02-10 11:04:49 +0800 CST'>February 10, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;23 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to virtualenv虚拟环境使用" href=https://examplesite.com/posts/python/virtualenv%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E4%BD%BF%E7%94%A8/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>博客内容本地推送至github</h2></header><div class=entry-content><p>1. github创建空的仓库，给予xxxxx.io名字，公开权限 2. 克隆仓库至本地 git clone https://github.com/xxxxxxx 3. 本地hugo环境以及博客创建完成，本地关联远程github仓库 git remote add origin git@github.com:miawithcode/xxxxx 4. 本地编辑完的博客内容实用如下命令进行提交至github git pull --rebase origin main # 首次与远端同步 git add . git commit -m "...(修改的信息)" git push origin main</p></div><footer class=entry-footer><span title='2022-02-10 11:04:49 +0800 CST'>February 10, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;34 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to 博客内容本地推送至github" href=https://examplesite.com/posts/other/%E5%8D%9A%E5%AE%A2%E5%86%85%E5%AE%B9%E6%9C%AC%E5%9C%B0%E6%8E%A8%E9%80%81%E8%87%B3github/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>操作系统级故障总结</h2></header><div class=entry-content><p>西安管线项目操作系统级故障报告 1. 发生时间 2023-06-09 2. 故障现象 主要数据库15服务器，操作系统进入只读模式，导致无法进行其余操作。系操作系统文件损坏，属于基础环境层问题，与应用层无关。 3. 处理情况 已使用操作系统自带修复工具修复系统文件损坏，目前操作系统使用正常。 4. 事件回顾 接院方通知2023-06-09通知礼拜天机房要停电，需要对相关服务器进行关机操作，下班之时对管线系统部署的19、15服务器进行关机操作。19服务器停止软件服务关机正常，15服务器停止软件服务时，提示"sudo docker-compose down XXXXXXX: Read-only file system"，服务无法停止无论做何种操作都是此提示，怀疑是磁盘占用已满检查后磁盘占用正常。经重启之后提示如下： 查阅官方资料、互联网结果是操作系统文件丢失或者损坏导致操作系统出现问题。因停电缘故修复工作放置上班时间。2023-06-10突然接到通知需要进行演示汇报工作，随即到达院现场开展修复工作和备用服务器启用工作。 5. 修复处理及原因 5.1 备用服务器启用 开始启用44、43服务器当作临时演示服务器使用，重启中发现数据盘挂载与操作系统目录冲突原因导致挂载失败，进入操作系统急救模式，取消自动挂载。编辑nano /etc/fstab文件取消自动挂在错误数据盘，重启正常进入系统，再次手动处理数据盘挂载，先使应用程序运行起来，数据盘挂载问题需要后期重新数据盘挂载。在使用中发现44服务器偶有界面卡死情况出现，其中2023-06-10系统测试中出现一次，怀疑跟操作系统桌面及数据盘挂载方式错误有关，需后期调整服务器和相关配置，再次检验服务器状态。 5.2 15数据库服务器修复 修复系统损坏文件。 按照提示采用fscl -y /dev/mapper/debian01--vg-root命令对操作系统损坏文件进行修复，执行完成之后正常进入系统，检查系统可正常使用。 修复journald服务文件。 启动管线程序时提示xxxx systemd-journald[xxxx]: Failed to write entry (19 items, 505 bytes), ignoring: Cannot assign requested address大量提示，经检查是操作自带journald服务写日志错误，系操作系统文件损坏导致此服务纪录出错。 通过 journalctl –verify 命令找到损坏journalctl文件，移动损坏的文件。 重启启动 systemd-journald 服务即可正常启动应用程序 sudo systemctl restart systemd-journald.service 通过dmesg命令检查，再无相关错误 重启启动管线服务正常。 修复postgrs 11 数据损坏文件。 经检查数据库启动日志信息，发现postgres11 数据库盘也有出现损坏情况，按照提示使用e2fsck -a -y /de/vgdata对损坏磁盘进行修复，数据库恢复正常。经检查sde空间库修复之后无数据，怀疑为数据库表损坏导致需后期排查。 利用备份数据还原数据库。 备份恢复为最有效解决方案，检查脚本最近期备份为 2023-06-07 差两天业务数据，经同意使用此备份进行恢复处理。 备份dxgx_xian(业务)、sde_dxgx(空间库)数据库，并修改数据库名称与原数据库名不冲突即可。 进入postgres容器内利用数据库自带脚本进行备份恢复处理 shell > sudo docker exec -it postgres bash # 进入postgres容器 shell > su postgres # 切换到postgres账户 shell > createdb dxgx_xian # 创建业务库 shell > createdb sde_dxgx # 创建空间库 shell > pg_restore -f dxgx_xian /var/lib/postgres/backup/dxgx_xian-2023-06-07-21-00-00.dmp shell > pg_restore -f sde_dxgx /var/lib/postgres/backup/sde_dxgx-2023-06-07-21-00-00.dmp 检查管线数据与业务数据正常，重新发布管线二维地图服务，测试管线系统正常加载，统计、查询等功能都正常使用。 5.3 查找原因 分析系统日志，使用journalctl查询系统出错日志信息，但因系统文件损坏导致6月9日相关系统日志未能记录和写入，无法查到具体日志信息 分析命令历史，使用history查找命令使用历史，未查找到有用信息 服务器存储还未做坏道测试，如有需要可安排进行一次检查 6 总计 事发突然，说明应急手段不全及相关技术基础支持掌握不到位。以下为相关建议：
...</p></div><footer class=entry-footer><span title='2022-02-10 11:04:49 +0800 CST'>February 10, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;153 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to 操作系统级故障总结" href=https://examplesite.com/posts/other/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%BA%A7%E6%95%85%E9%9A%9C%E6%80%BB%E7%BB%93/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>跑步页面搭建</h2></header><div class=entry-content><p>1. 参考仓库 https://github.com/yihong0618/running_page 2. 自己搭建完的仓库 https://github.com/langhaidian/running_page 3. 效果展示内容 vercel站点“running page” github.io站点“running page”</p></div><footer class=entry-footer><span title='2022-02-10 11:04:49 +0800 CST'>February 10, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;12 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to 跑步页面搭建" href=https://examplesite.com/posts/other/running/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://examplesite.com/>«&nbsp;Prev&nbsp;</a></nav></footer></main><footer class=footer><span>&copy; 2024 <a href=https://examplesite.com/>langhaidian</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>