<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | langhaidian</title>
<meta name=keywords content><meta name=description content="Posts - langhaidian"><meta name=author content="Me"><link rel=canonical href=https://examplesite.com/posts/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://examplesite.com/posts/index.xml><link rel=alternate hreflang=en href=https://examplesite.com/posts/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://examplesite.com/posts/"><meta property="og:site_name" content="langhaidian"><meta property="og:title" content="Posts"><meta property="og:description" content="ExampleSite description"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://examplesite.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://examplesite.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Posts"><meta name=twitter:description content="ExampleSite description"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://examplesite.com/posts/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://examplesite.com/ accesskey=h title="Home (Alt + H)"><img src=https://examplesite.com/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://examplesite.com/archives/ title=归档><span>归档</span></a></li><li><a href=https://examplesite.com/tags/ title=标签><span>标签</span></a></li><li><a href=https://examplesite.com/about/ title=关于><span>关于</span></a></li><li><a href=https://langhaidian.github.io/running_page title=running_page><span>running_page</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://examplesite.com/>Home</a></div><h1>Posts
<a href=/posts/index.xml title=RSS aria-label=RSS><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>linux设置时间</h2></header><div class=entry-content><p>最近碰到搭建测试k8s环境，系统版本太低导致很多问题，进行google后整理的升级步骤，供参考。 1. 系统时间查看和设置 查看系统时间的命令： #date 设置系统时间的命令： #date +"月/日/年 时:分:秒" [root@localhost sbin]# date +"12/13/2021 12:13:14" 12/13/2021 12:13:14 [root@localhost sbin]# date Sat May 29 18:02:37 CST 2021 2. 设置硬件时间 查看硬件时间的命令： # hwclock 设置硬件时间的命令： # hwclock --set --date="月/日/年 时:分:秒" [root@localhost sbin]# hwclock --set --date="2/1/2021 1:2:3" [root@localhost sbin]# hwclock Mon 01 Feb 2021 01:02:09 AM CST -0.848901 seconds 将系统时间写入硬件时间。hwclock --systohc</p></div><footer class=entry-footer><span title='2024-08-10 11:04:49 +0800 CST'>August 10, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;56 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to linux设置时间" href=https://examplesite.com/posts/linux/linux%E8%AE%BE%E7%BD%AE%E6%97%B6%E9%97%B4/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>mkcert生成GeosceneServer证书</h2></header><div class=entry-content><p>解决Geoscene Server证书自己生成碰到浏览器不信任问题。采用mkcert工具生成相关证书。 准备软件： mkcert： https://github.com/FiloSottile/mkcert/releases openssl：https://slproweb.com/download/Win64OpenSSL_Light-1_1_1q.msi
证书生成 定位到mkcert目录下，查看帮助
mkcert --help 安装CA证书
mkcert -install 生成证书,可以给定ip地址，*.portal.com通配符域名，具体域名gx42.portal.com等。当前目录下会生成两个.pem文件。
mkcert 192.168.28.42 192.168.28.215 "*.portal.com" gx42.portal.com 将192.168.X.X-key.pem文件转换成key openssl rsa -in 192.168.X.X.pem -out 192.168.X.X.key 利用openssl生成pfx证书,设定密码以及记录相关密码，tomcat配置时使用。
openssl> pkcs12 -export -out d:\mkcert\192.168.X.X.pfx -in d:\mkcert\192.168.X.X.pem -inkey d:\mkcert\192.168.X.X.key 查找CA证书安装位置
mkcert -CAROOT 将 rootCA.pem 转换成.crt格式，用于客户端安装自签名证书使用
openssl x509 -in rootCA.pem -out rootCA.crt 双击rootCA.crt进行安装,按照提示将证书存储到受信任的根证书颁发机构。
配置tomcat证书信息
&lt;!--&lt;Connector port="8443" protocol="org.apache.coyote.http11.Http11NioProtocol....>" --> Modify the connector to match the parameters below: &lt;Connector port="443" protocol="org.apache.coyote.http11.Http11AprProtocol" maxThreads="150" SSLEnabled="true" > &lt;UpgradeProtocol className="org.apache.coyote.http2.Http2Protocol" /> &lt;SSLHostConfig> &lt;Certificate certificateKeystoreFile="conflocalhost-rsa-key.pem" certificateKeystorePassword="con" type="RSA" /> &lt;/SSLHostConfig> &lt;/Connector> &lt;Connector port="443" protocol="org.apache.coyote.http11.Http11AprProtocol" maxThreads="150" SSLEnabled="true" > &lt;UpgradeProtocol className="org.apache.coyote.http2.Http2Protocol" /> &lt;SSLHostConfig> &lt;Certificate certificateKeystoreFile="conf/ssl/172.26.156.21.pfx" certificateKeystorePassword="gxzb@123" type="PKCS12" /> &lt;/SSLHostConfig> &lt;/Connector> keytools: keytool -genkey -alias mykey -keyalg RSA -keystore keystore.jks -validity 3650 &lt;Connector port="443" protocol="org.apache.coyote.http11.Http11AprProtocol" maxThreads="150" SSLEnabled="true" scheme="https" secure="true" keystoreFile="/path/to/keystore.jks" keystorePass="password" clientAuth="false" sslProtocol="TLS"/> &lt;Connector port="443" protocol="org.apache.coyote.http11.Http11NioProtocol" maxThreads="550" SSLEnabled="true" scheme="https" secure="true" keystoreFile="ssl/anyangarcgis.jks" keystorePass="anyang" clientAuth="false" sslProtocol="TLS"/> &lt;Connector port="443" protocol="org.apache.coyote.http11.Http11NioProtocol" maxThreads="550" SSLEnabled="true"> &lt;UpgradeProtocol className="org.apache.coyote.http2.Http2Protocol"/> &lt;SSLHostConfig> &lt;Certificate certificateKeystoreFile="conf/cert/xkcdxgx.pfx" certificateKeystorePassword="anyang" type="RSA"/> &lt;/SSLHostConfig> &lt;/Connector> {"WebContextURL":"https://59.227.104.202/arcgis"} nginx: server { listen 443 ssl; server_name 59.227.104.202 10.10.146.36 gx36.portal.com; ssl_certificate /etc/nginx/ssl/gx36.portal.com+5.pem ssl_certificate_key /etc/nginx/ssl/gx36.portal.com+5-key.pem ssl_session_cache shared:SSL:1m; ssl_session_timeout 5m; ssl_ciphers HIGH:!aNULL:!MD5; ssl_prefer_server_ciphers on; location /server { proxy_pass https://gx36.portal.com/server; proxy_ignore_client_abort on; proxy_cookie_path /server /server proxy_set_header Host $host:$server_port; proxy_set_header X-Real-IP ""; # ArcGIS Server 要求必须添加 X-Forwarded-Host 反代标头 proxy_set_header X-Real-PORT $remote_port; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; } location /arcgis { proxy_pass https://gx36.portal.com/arcgis; proxy_ignore_client_abort on; proxy_cookie_path /arcgis /arcgis proxy_set_header Host $host:$server_port; proxy_set_header X-Real-IP ""; # ArcGIS Server 要求必须添加 X-Forwarded-Host 反代标头 proxy_set_header X-Real-PORT $remote_port; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; } }</p></div><footer class=entry-footer><span title='2024-08-10 11:04:49 +0800 CST'>August 10, 2024</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;225 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to mkcert生成GeosceneServer证书" href=https://examplesite.com/posts/linux/mkcert%E7%94%9F%E6%88%90geosceneserver%E8%AF%81%E4%B9%A6/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>跑步页面搭建</h2></header><div class=entry-content><p>1. 参考仓库 https://github.com/yihong0618/running_page 2. 自己搭建完的仓库 https://github.com/langhaidian/running_page 3. 效果展示内容 vercel站点“running page” github.io站点“running page”</p></div><footer class=entry-footer><span title='2024-08-10 11:04:49 +0800 CST'>August 10, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;12 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to 跑步页面搭建" href=https://examplesite.com/posts/other/running/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>geoscen server基础部署-centos 7.6</h2></header><div class=entry-content><p>1. 准备工作 1.1 关闭防火墙
停止防火墙：systemctl stop firewalld.service 禁用防火墙的开机启动：systemctl disable firewalld.service 查看防火墙状态：systemctl status firewalld.service 1.2 用户和组创建
# groupadd xcy # useradd -g xcy -m geoscene //绑定用户和用户组 # passwd geoscene //设置密码geoscene 1.3 修改计算机名：
# hostname //查看计算机名 # vi /etc/hostname 编辑机器名为xcytest后保存退出 # vi /etc/sysconfig/network 文件中的hostname修改为xcytest 1.4 修改hosts文件
# vi /etc/hosts 192.168.0.130 xcytest.portal.com xcytest //增加配置信息 1.5 检查主机名是否生效
# hostname xcytest //让修改立即生效 # hostname -f //查看完全限定域名 xcytest.portal.com 1.6 检查磁盘大小情况
df -h 确保/home/径路下存储空间满足要求 1.7 准备安装包 安装包：geoscene_datastore、geoscene_portal、geoscne_server、geoscene_webadapter_java 将安装包上传到/home/geoscen/azb
...</p></div><footer class=entry-footer><span title='2024-07-10 11:04:49 +0800 CST'>July 10, 2024</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;291 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to geoscen server基础部署-centos 7.6" href=https://examplesite.com/posts/linux/geoscenserver2.0%E5%9F%BA%E7%A1%80%E9%83%A8%E7%BD%B2/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>iperf测试带宽</h2></header><div class=entry-content><p>有项目需求需要测试局域网内带宽，网上整理后输出。 设置服务器端 iperf -s -w 2m 缓存区2m单向测试，-s代表服务器端
设置客户端 iperf -c serverip -w 2m -t 30s -i 1s 缓存区2m单向测试，运行时间30秒，每秒显示一次结果
iperf -c serverip -u -b 500M -w 2m -t 30s -i 1s 测试500m带宽，使用udp协议
常用选项： -f, --format [kmKM] 报告格式：Kbits、Mbits、KBytes、MBytes -h, --help 打印帮助大纲 -i, --interval n 在定期带宽报告之间暂停 n 秒 -l, --len n[KM] 将读/写缓冲区长度设置为 n（默认为 8 KB） -m, --print_mss 打印 TCP 最大数据段长度（MTU - TCP/IP 标头） -o, --output &lt;filename> 将报告或错误消息输出到此指定文件 -p, --port n 将要侦听/连接的服务器端口设置为 n（默认为 5001） -u, --udp 使用 UDP 而不是 TCP -w, --window n[KM] TCP 窗口大小（套接字缓冲区大小） -B, --bind &lt;host> 绑定到 &lt;host>，接口或多播地址 -C, --compatibility 用于较低版本，不发送额外消息 -M, --mss n 设置 TCP 最大数据段长度（MTU - 40 字节） -N, --nodelay 设置 TCP no delay，禁用 Nagle 算法 -v, --version 打印版本信息并退出 -V, --IPv6Version 将域设置为 IPv6 -x, --reportexclude [CDMSV] 排除 C(connection) D(data) M(multicast) S(settings) V(server) 报告 -y, --reportstyle C|c 是否设置 C 或 c 报告结果为 CSV（逗号分隔值） 特定于服务器的选项： -s, --server 在服务器模式下运行 -U, --single_udp 在单线程 UDP 模式下运行 -D, --daemon 将服务器作为守护程序运行 特定于客户端的选项： -b, --bandwidth n[KM] 将目标带宽设置为 n 位/秒（默认为 1 Mbit/秒）。此 设置需要 UDP (-u)。 -c, --client &lt;host> 在客户端模式下运行，连接到 &lt;host> -d, --dualtest 同时执行双向测试 -n, --num n[KM] 要传输的字节数（而不是 -t） -r, --tradeoff 单独执行双向测试 -t, --time n 传输时间，以秒为单位（默认为 10 秒） -F, --fileinput &lt;name> 从文件输入要传输的数据 -I, --stdin 从 stdin 输入要传输的数据 -L, --listenport n 接收回双向测试的端口 -P, --parallel n 要并行运行的客户端线程数 -T, --ttl n 多播的存活时间（默认为 1） -Z, --linux-congestion &lt;algo> 设置 TCP 拥塞控制算法（仅限 Linux）</p></div><footer class=entry-footer><span title='2024-07-10 11:04:49 +0800 CST'>July 10, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;207 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to iperf测试带宽" href=https://examplesite.com/posts/linux/iperf%E6%B5%8B%E8%AF%95%E5%B8%A6%E5%AE%BD/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>raft算法中文讲解</h2></header><div class=entry-content><p>寻找一种易于理解的一致性算法（扩展版） 寻找一种易于理解的一致性算法（扩展版） 摘要 1 介绍 2 复制状态机 3 Paxos 算法的问题 4 为了可理解性的设计 5 Raft 一致性算法 5.1 Raft 基础 5.2 领导人选举 5.3 日志复制 5.4 安全性 5.4.1 选举限制 5.4.2 提交之前任期内的日志条目 5.4.3 安全性论证 5.5 跟随者和候选人崩溃 5.6 时间和可用性 6 集群成员变化 7 日志压缩 8 客户端交互 9 算法实现和评估 9.1 可理解性 9.2 正确性 9.3 性能 10 相关工作 11 结论 12 感谢 参考 摘要 Raft 是一种为了管理复制日志的一致性算法。它提供了和 Paxos 算法相同的功能和性能，但是它的算法结构和 Paxos 不同，使得 Raft 算法更加容易理解并且更容易构建实际的系统。为了提升可理解性，Raft 将一致性算法分解成了几个关键模块，例如领导人选举、日志复制和安全性。同时它通过实施一个更强的一致性来减少需要考虑的状态的数量。一项用户研究的结果表明，对于学生而言，Raft 算法比 Paxos 算法更加容易学习。Raft 算法还包括一个新的机制来允许集群成员的动态改变，它利用重叠的大多数来保证安全性。
1 介绍 一致性算法允许一组机器像一个整体一样工作，即使其中一些机器出现故障也能够继续工作下去。正因为如此，一致性算法在构建可信赖的大规模软件系统中扮演着重要的角色。在过去的 10 年里，Paxos 算法统治着一致性算法这一领域：绝大多数的实现都是基于 Paxos 或者受其影响。同时 Paxos 也成为了教学领域里讲解一致性问题时的示例。
...</p></div><footer class=entry-footer><span title='2024-07-10 11:04:49 +0800 CST'>July 10, 2024</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;1565 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to raft算法中文讲解" href=https://examplesite.com/posts/linux/raft-zh_cn/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>centos7离线安装docker</h2></header><div class=entry-content><p>内网环境centos 7.2需要安装docker，并运行相关系统 1. 查看内核版本 uname -msr 2. 更新软件版本 docker run –rm -v ${PWD}/bin:/tmp -it centos:7.6.1810 bash
In the online container: cd /tmp yum-config-manager –add-repo=https://download.docker.com/linux/centos/docker-ce.repo yum install -y yum-utils yum makecache fast yum list docker-ce –showduplicates | sort -r yumdownloader –resolve docker-ce-18.06.3.ce-3.el7 docker-ce-cli-24.0.7-1.el7 containerd.io-1.6.27-3.1.el7 docker-buildx-plugin-0.11.2-1.el7 docker-compose-plugin-2.21.0-1.el7 yum-utils
rpm -ivh –replacefiles –replacepkgs .rpm rpm -ivh ./openssh74pl/.rpm –force –nodeps
docker run –rm -v ${PWD}/bin:/tmp -it debian:11.7 bash
默认存放下载的deb文件的路径是 /var/cache/apt/archives
apt install –download-only xxxx
...</p></div><footer class=entry-footer><span title='2024-06-10 11:04:49 +0800 CST'>June 10, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;80 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to centos7离线安装docker" href=https://examplesite.com/posts/linux/cnetos7%E5%B0%8F%E7%89%88%E6%9C%AC%E5%AE%89%E8%A3%85docker/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>debian 11基础环境准备</h2></header><div class=entry-content><p>1. 替换默认源 cat &lt;&lt; EOF > /etc/apt/sources.list # Official sources.list deb http://deb.debian.org/debian bullseye main contrib non-free deb-src http://deb.debian.org/debian bullseye main contrib non-free deb http://deb.debian.org/debian bullseye-updates main contrib non-free deb-src http://deb.debian.org/debian bullseye-updates main contrib non-free deb http://deb.debian.org/debian bullseye-backports main contrib non-free deb-src http://deb.debian.org/debian bullseye-backports main contrib non-free deb http://security.debian.org/debian-security/ bullseye-security main contrib non-free deb-src http://security.debian.org/debian-security/ bullseye-security main contrib non-free EOF 更新系统： sudo apt update #更新源 sudo apt upgrade #更新已安装的包 sudo apt dist-upgrade #升级系统 sudo apt clean && sudo apt autoclean #清理下载文件的存档 2. 给root账户设置或者修改密码 passwd root 3. 安装sudo apt install sudo **给普通用户添加sudo权限 usermod -a -G sudo XXXX 4. 默认root禁止ssh远程登录(推荐保持默认) 修改配置文件 sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak sudo vi /etc/ssh/sshd_config #Authentication: #LoginGraceTime 2m #PermitRootLogin prohibit-password #StrictModes yes #MaxAuthTries 6 #MaxSessions 10 #PubkeyAuthentication yes 增加一句 PermitRootLogin yes 快速配置： sudo sed -i "/^#PermitRootLogin/c"PermitRootLogin" " yes"" /etc/ssh/sshd_config 补充： PermitRootLogin prohibit-password #允许 root 登录，但禁止适用密码认证 可以配合使用 Pubkey 认证，修改 PubkeyAuthentication yes 重启服务生效： sudo systemctl restart ssh 5. 配置网络 vim /etc/network/interfaces ============ # 修改为以下内容： iface lo inet loopback auto lo auto eth0 iface eth0 inet static address 10.10.1.5 netmask 255.255.255.0 #broadcast 10.10.1.255 #可选，上述配置了掩码 #network 10.10.1.0 #可选，上述配置了掩码 gateway 10.10.1.1 #dns-domain sysin.org # domain 和 search 不能共存；如果同时存在，后面出现的将会被使用。 dns-search sysin.org dns-nameservers 10.10.1.1 8.8.8.8 #注意 debian 11 默认没有安装 resolvconf，所以需要手动在 resolv.conf 中编辑 DNS ============ # 或者安装 resolvconf 后，在这里配置，将自动更新 resolv.conf sudo apt install resolvconf # iface eth0 inet6 auto #ipv6 自动配置，不写则表示禁用了 ============ # DHCP 配置如下： auto eth0 iface eth0 inet dhcp ============= # 配置 DNS cat /etc/resolv.conf #如果已经安装 resolvconf，不要手动编辑，直接在上述 interfaces 中编辑 dns ============= # 重启网络 sudo systemctl restart networking #sudo service networking restart ================= 配置多个ip auto eth0:0 iface eth0:0 inet static address 192.168.1.90 netmask 255.255.255.0 auto eth0:1 iface eth0:1 inet static address 192.168.1.91 netmask 255.255.255.0 gateway 192.168.1.1 ======= #添加静态路由信息 cat >> /etc/network/interfaces &lt;&lt;EOF # static routes up ip route add 10.10.12.0/24 via 10.10.1.1 dev eth0 up ip route add 10.10.13.0/24 via 10.10.1.1 dev eth0 up ip route add 10.10.14.0/24 via 10.10.1.1 dev eth0 up ip route add 10.10.15.0/24 via 10.10.1.1 dev eth0 up ip route add 10.10.16.0/24 via 10.10.1.1 dev eth0 EOF #重启网络 systemctl restart networking #验证 ip route 6. 修改主机名 vim /etc/hostname hostnamectl set-hostname debian-01 --static vim /etc/hosts # 添加一行 127.0.0.1 debian01.sysin.org debian01 # 注意这里的格式，IP 后面先写 FQDN 再写主机名，与 CentOS 相同 # 先写 FQDN 后写主机名，顺序反了不影响解析，但是'hostname -f'命令无法显示 FQDN，只能显示主机名 7. 安装intel无线网卡 查看网线设备信息 lspci -nn 安装wifi驱动包 apt update && apt install firmware-iwlwifi 重新加载wifi模块 modprobe -r iwlwifi ; modprobe iwlwifi 8. 修改默认ulimt参数 cat &lt;&lt; EOF >> /etc/security/limits.conf * soft nofile 65535 * hard nofile 65535 * soft nproc 65535 * hard nproc 65535 EOF cat &lt;&lt; EOF > /etc/security/limits.d/20-nproc.conf * soft nproc 65535 root soft nproc unlimited EOF 9. 安装openjdk8 ##sudo apt install apt-transport-https ca-certificates wget dirmngr gnupg software-properties-common wget -qO - https://adoptopenjdk.jfrog.io/adoptopenjdk/api/gpg/key/public | sudo apt-key add - sudo add-apt-repository --yes https://adoptopenjdk.jfrog.io/adoptopenjdk/deb/ sudo apt-get update && sudo apt-get install adoptopenjdk-8-hotspot sudo apt update sudo apt install adoptopenjdk-8-hotspot 10. 安装docker及docker-compose ## 卸载旧版本软件 sudo apt-get remove docker docker-engine docker.io containerd runc ## 安装依赖 sudo apt-get update sudo apt-get install \ ca-certificates \ curl \ gnupg \ lsb-release ## 导入gpg key curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg ## 添加仓库 echo \ "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/debian \ $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null ## 开始安装 sudo apt-get update sudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin 11. 设置时区 通过timedatectl进行设置 检查当前时区: timedatectl Local time: Fri 2020-04-03 19:23:29 UTC Universal time: Fri 2020-04-03 19:23:29 UTC RTC time: Fri 2020-04-03 19:23:29 Time zone: UTC (UTC, +0000) ..... ##更改时区 timedatectl list-timezones ｜ grep Shanghai ##过滤上海时区 sudo timedatectl set-timezone your_time_zone ##更改时区 sudo timedatectl set-timezone Asia/Shanghai ##设置上海时区 ##查看和验证时区 timedatectl Local time: Fri 2020-04-03 13:30:30 CST Universal time: Fri 2020-04-03 19:30:30 UTC RTC time: Fri 2020-04-03 19:30:30 Time zone: America/Monterrey (CST, -0600) ....... date ## 查看具体时间 通过软连接进行设置 较旧版本debian，没有timedatectl可以通过软连接进行设置，可以通过/etc/localtime文件符号链接到/usr/share/zoShanghai
...</p></div><footer class=entry-footer><span title='2024-06-10 11:04:49 +0800 CST'>June 10, 2024</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;691 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to debian 11基础环境准备" href=https://examplesite.com/posts/linux/debian11/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>centos7内核4.19升级到5.14</h2></header><div class=entry-content><p>最近碰到搭建测试k8s环境，系统版本太低导致很多问题，进行google后整理的升级步骤，供参考。 1. 查看内核版本 uname -msr 2. 更新软件版本 sudo yum -y update 3. 导入eplr rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org 4. ELRepo yum install https://www.elrepo.org/elrepo-release-7.el7.elrepo.noarch.rpm 5. 查找现有内核版本 yum list available --disablerepo='*' --enablerepo=elrepo-kernel * ML为主线版本，LT为长期支持版本 6. 安装内核版本 sudo yum --enablerepo=elrepo-kernel install kernel-lt 7. 删除旧版本tools yum remove kernel-tools-libs.x86_64 kernel.x86_64 -y yum remove kernel-tools-libs.x86_64 kernel-tools.x86_64 -y 8. 安装工具包 yum --disablerepo=\* --enablerepo=elrepo-kernel install kernel-lt-tools.x86_64 -y 9. 重启手动选择内核进入系统检查系统情况 reboot 10. 查看所有启动内核 awk -F \' '$1=="menuentry " {print i++ " : " $2}' /etc/grub2.cfg 修改默认启动内核：grub2-set-default 0 11. 编辑启动顺序 sudo vim /etc/default/grub --------------------- * Once the file opens, look for the line that says GRUB_DEFAULT=X, and change it to GRUB_DEFAULT=0 (zero). * This line will instruct the boot loader to default to the first kernel on the list, which is the latest. 将GRUB_DEFAULT=X 修改成GRUB_DEFAULT=0 加载第一个内核版本并且为最后一个版本 12. 更新启动配置文件 sudo grub2-mkconfig -o /boot/grub2/grub.cfg 13. 查看启动顺序 grub2-editenv list 14. 重启验证 reboot</p></div><footer class=entry-footer><span title='2024-05-10 11:04:49 +0800 CST'>May 10, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;137 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to centos7内核4.19升级到5.14" href=https://examplesite.com/posts/linux/cnetos7%E5%8D%87%E7%BA%A7%E5%86%85%E6%A0%B8/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>containerd安装</h2></header><div class=entry-content><p>debian 11安装(建议debian内核为5.11以后)
需要安装内容 containerd、runc、CNI plugins、nerdctl(客户端) 安装containerd a. 进入下载对应版本https://github.com/containerd/containerd/releases wget https://github.com/containerd/containerd/releases/download/v1.7.2/containerd-1.7.2-linux-amd64.tar.gz b. shell> tar Cxzvf /usr/local containerd-1.6.2-linux-amd64.tar.gz bin/ c. 配置开机启动服务 服务配置文件内容：https://raw.githubusercontent.com/containerd/containerd/main/containerd.service vim /etc/systemd/system/containerd.service ---------------- # Copyright The containerd Authors. # # Licensed under the Apache License, Version 2.0 (the "License"); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an "AS IS" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. [Unit] Description=containerd container runtime Documentation=https://containerd.io After=network.target local-fs.target [Service] #uncomment to enable the experimental sbservice (sandboxed) version of containerd/cri integration #Environment="ENABLE_CRI_SANDBOXES=sandboxed" ExecStartPre=-/sbin/modprobe overlay ExecStart=/usr/local/bin/containerd Type=notify Delegate=yes KillMode=process Restart=always RestartSec=5 # Having non-zero Limit*s causes performance problems due to accounting overhead # in the kernel. We recommend using cgroups to do container-local accounting. LimitNPROC=infinity LimitCORE=infinity LimitNOFILE=infinity # Comment TasksMax if your systemd version does not supports it. # Only systemd 226 and above support this version. TasksMax=infinity OOMScoreAdjust=-999 [Install] WantedBy=multi-user.target ----------------- shell> systemctl daemon-reload shell> systemctl enable --now containerd 安装runc 下载对应安装文件：https://github.com/opencontainers/runc/releases shell> install -m 755 runc.amd64 /usr/local/sbin/runc 安装CNI plugins 下载对应安装文件：https://github.com/containernetworking/plugins/releases shell> mkdir -p /opt/cni/bin shell> tar Cxzvf /opt/cni/bin cni-plugins-linux-amd64-v1.1.1.tgz 安装nerdctl 下载对应安装文件：https://github.com/containerd/nerdctl/releases shell> tar Cxzvvf /usr/local/bin nerdctl-1.4.0-linux-amd64.tar.gz 配置：Rootless a. 安装依赖： shell> sudo apt-get purge apparmor apparmor-utils auditd shell> sudo apt-get install uidmap shell> sudo apt-get install slirp4netns 特殊配置： 1. 开启overlay echo "options overlay permit_mounts_in_userns=1" > /etc/modprobe.d/mdadm.conf 2. 开启配置cgroup v2 shell> vim /etc/default/grub ------ GRUB_CMDLINE_LINUX="systemd.unified_cgroup_hierarchy=1" ------ shell> sudo update-grub. -------- Enabling CPU, CPUSET, and I/O delegation $ cat /sys/fs/cgroup/user.slice/user-$(id -u).slice/user@$(id -u).service/cgroup.controllers memory pids $ sudo mkdir -p /etc/systemd/system/user@.service.d $ cat &lt;&lt;EOF | sudo tee /etc/systemd/system/user@.service.d/delegate.conf [Service] Delegate=cpu cpuset io memory pids EOF $ sudo systemctl daemon-reload --------- shell> containerd-rootless-setuptool.sh install iptable 问题： I had the same issue and in my system (debian bullseye) iptables and ip6tables was installed only under /usr/sbin. A quick fix was to make a link in /usr/local/bin ln -s /usr/sbin/iptables /usr/local/bin/iptables ln -s /usr/sbin/ip6tables /usr/local/bin/ip6tables</p></div><footer class=entry-footer><span title='2024-05-10 11:04:49 +0800 CST'>May 10, 2024</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;353 words&nbsp;·&nbsp;langhaidian</footer><a class=entry-link aria-label="post link to containerd安装" href=https://examplesite.com/posts/linux/containerd%E5%AE%89%E8%A3%85/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://examplesite.com/posts/page/2/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2024 <a href=https://examplesite.com/>langhaidian</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>